<!DOCTYPE html><html lang="zh-CN"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>销售数据大屏 - 数字增长部</title>
    <!-- 引入 ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        :root {
            --bg-color: #0b1120;
            --card-bg: #1e293b;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --accent-color: #3b82f6;
            --border-color: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            overflow-x: hidden;
            padding: 20px;
        }

        /* 头部样式 */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 15px;
        }

        h1 {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(to right, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .status-badge {
            font-size: 12px;
            background: rgba(16, 185, 129, 0.2);
            color: #34d399;
            padding: 5px 10px;
            border-radius: 15px;
            border: 1px solid rgba(16, 185, 129, 0.4);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background-color: #34d399;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        /* 核心指标卡片 */
        .kpi-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .kpi-card {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .kpi-title {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .kpi-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--text-primary);
        }

        .kpi-trend {
            font-size: 12px;
            margin-top: 5px;
        }

        .trend-up { color: #34d399; }
        .trend-down { color: #f87171; }

        /* 图表网格布局 */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 20px;
            height: calc(100vh - 200px);
            min-height: 600px;
        }

        .chart-card {
            background-color: var(--card-bg);
            border-radius: 10px;
            border: 1px solid var(--border-color);
            padding: 15px;
            display: flex;
            flex-direction: column;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 16px;
            font-weight: 500;
        }

        .chart-body {
            flex: 1;
            width: 100%;
            min-height: 0; /* 防止溢出 */
        }

        /* 布局分配 */
        .grid-col-8 { grid-column: span 8; } /* 大图占8列 */
        .grid-col-4 { grid-column: span 4; } /* 小图占4列 */
        .grid-row-2 { grid-row: span 2; }

        /* 响应式调整 */
        @media (max-width: 1200px) {
            .grid-col-8, .grid-col-4 { grid-column: span 12; }
            .charts-grid { height: auto; display: flex; flex-direction: column; }
            .chart-body { height: 300px; }
        }

        @keyframes pulse {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(52, 211, 153, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 6px rgba(52, 211, 153, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(52, 211, 153, 0); }
        }
    </style>
</head>
<body>

    <header>
        <div>
            <h1>销售数据大屏 Demo</h1>
            <div style="font-size: 12px; color: var(--text-secondary); margin-top: 5px;">数字增长部 | 实时数据监控系统</div>
        </div>
        <div class="status-badge">
            <div class="status-dot"></div>
            系统已连接 (API: /v1/sales/realtime)
        </div>
    </header>

    <!-- 关键指标区域 (KPI) -->
    <div class="kpi-container">
        <div class="kpi-card">
            <div class="kpi-title">本月总签约额 (万元)</div>
            <div class="kpi-value" id="total-sales">0</div>
            <div class="kpi-trend trend-up">↑ 12.5% 环比增长</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-title">本月新增签约项目数</div>
            <div class="kpi-value" id="new-projects">0</div>
            <div class="kpi-trend trend-up">↑ 5 个 新增</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-title">平均销售周期 (天)</div>
            <div class="kpi-value" id="avg-cycle">0</div>
            <div class="kpi-trend trend-down">↓ 3天 效率提升</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-title">活跃销售分公司</div>
            <div class="kpi-value">8</div>
            <div class="kpi-trend" style="color: #60a5fa;">全员在线</div>
        </div>
    </div>

    <!-- 图表区域 -->
    <div class="charts-grid">
        
        <!-- 1. 月度项目签约趋势 (折线图 + 柱状图) -->
        <div class="chart-card grid-col-8">
            <div class="chart-header">
                <span>月度项目签约趋势 (2023-2024)</span>
                <select style="background:#0f172a; color:white; border:1px solid #334155; padding:2px 5px; border-radius:4px;">
                    <option>全部项目</option>
                    <option>SaaS平台</option>
                    <option>定制开发</option>
                </select>
            </div>
            <div id="trendChart" class="chart-body"></div>
        </div>

        <!-- 2. 客户渠道来源分析 (南丁格尔玫瑰图) -->
        <div class="chart-card grid-col-4">
            <div class="chart-header">签约客户渠道来源分布</div>
            <div id="channelChart" class="chart-body"></div>
        </div>

        <!-- 3. 分公司销售业绩排行 (条形图) -->
        <div class="chart-card grid-col-4">
            <div class="chart-header">分公司/团队 业绩排行 TOP 5</div>
            <div id="companyRankChart" class="chart-body"></div>
        </div>

        <!-- 4. 销售周期与项目类型散点图 (模拟复杂分析) -->
        <div class="chart-card grid-col-8">
            <div class="chart-header">销售周期 vs 签约金额分析</div>
            <div id="cycleChart" class="chart-body"></div>
        </div>

    </div>

    <script>
        // 初始化 ECharts 实例
        const trendChart = echarts.init(document.getElementById('trendChart'));
        const channelChart = echarts.init(document.getElementById('channelChart'));
        const companyRankChart = echarts.init(document.getElementById('companyRankChart'));
        const cycleChart = echarts.init(document.getElementById('cycleChart'));

        // 通用图表配置 (深色主题)
        const commonOption = {
            textStyle: { fontFamily: 'Segoe UI' },
            tooltip: {
                backgroundColor: 'rgba(30, 41, 59, 0.9)',
                borderColor: '#334155',
                textStyle: { color: '#f8fafc' }
            }
        };

        // --- 模拟后端数据接口 ---
        // 在真实场景中，这里会替换为 fetch('https://api.yourcompany.com/sales/data')
        function fetchSalesData() {
            return new Promise((resolve) => {
                // 模拟网络延迟
                setTimeout(() => {
                    resolve({
                        kpi: {
                            totalSales: 4850,
                            newProjects: 32,
                            avgCycle: 45
                        },
                        trend: {
                            months: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月'],
                            projectA: [120, 132, 101, 134, 90, 230, 210, 250, 280, 310], // 项目A签约额
                            projectB: [220, 182, 191, 234, 290, 330, 310, 350, 380, 410], // 项目B签约额
                            count: [5, 7, 4, 8, 6, 12, 10, 15, 14, 18] // 签约数量
                        },
                        channels: [
                            { value: 40, name: '老客复购' },
                            { value: 30, name: '销售自拓' },
                            { value: 15, name: '官网线索' },
                            { value: 10, name: '合作伙伴' },
                            { value: 5, name: '市场活动' }
                        ],
                        companies: [
                            { name: '北京总公司', value: 1200 },
                            { name: '上海分公司', value: 980 },
                            { name: '深圳分公司', value: 850 },
                            { name: '成都分公司', value: 620 },
                            { name: '杭州办事处', value: 450 }
                        ],
                        cycleData: [
                            // [销售周期(天), 签约金额(万元), 项目类型, 公司]
                            [15, 50, 'SaaS', '北京'], [35, 120, '定制', '上海'], [60, 300, '私有化', '深圳'],
                            [20, 45, 'SaaS', '成都'], [45, 150, '定制', '北京'], [80, 500, '私有化', '北京'],
                            [10, 30, 'SaaS', '杭州'], [25, 80, 'SaaS', '上海'], [55, 220, '定制', '深圳'],
                            [90, 450, '私有化', '上海'], [30, 100, '定制', '成都'], [18, 60, 'SaaS', '北京']
                        ]
                    });
                }, 800);
            });
        }

        // --- 渲染图表函数 ---

        async function renderDashboard() {
            const data = await fetchSalesData();

            // 1. 更新 KPI 数字 (带有简单的计数动画)
            animateValue("total-sales", 0, data.kpi.totalSales, 1000);
            animateValue("new-projects", 0, data.kpi.newProjects, 1000);
            animateValue("avg-cycle", 0, data.kpi.avgCycle, 1000);

            // 2. 渲染趋势图
            trendChart.setOption({
                ...commonOption,
                tooltip: { trigger: 'axis', axisPointer: { type: 'cross' } },
                legend: { data: ['项目A金额', '项目B金额', '签约总数'], textStyle: { color: '#94a3b8' } },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: {
                    type: 'category',
                    data: data.trend.months,
                    axisLine: { lineStyle: { color: '#334155' } },
                    axisLabel: { color: '#94a3b8' }
                },
                yAxis: [
                    { type: 'value', name: '金额 (万元)', position: 'left', axisLabel: { color: '#94a3b8' }, splitLine: { lineStyle: { color: '#334155', type: 'dashed' } } },
                    { type: 'value', name: '数量 (个)', position: 'right', axisLabel: { color: '#94a3b8' }, splitLine: { show: false } }
                ],
                series: [
                    { name: '项目A金额', type: 'bar', stack: 'total', data: data.trend.projectA, itemStyle: { color: '#3b82f6' } },
                    { name: '项目B金额', type: 'bar', stack: 'total', data: data.trend.projectB, itemStyle: { color: '#6366f1' } },
                    { name: '签约总数', type: 'line', yAxisIndex: 1, data: data.trend.count, itemStyle: { color: '#34d399' }, smooth: true }
                ]
            });

            // 3. 渲染渠道分布图
            channelChart.setOption({
                ...commonOption,
                tooltip: { trigger: 'item' },
                legend: { top: 'bottom', textStyle: { color: '#94a3b8' } },
                series: [
                    {
                        name: '渠道来源',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        avoidLabelOverlap: false,
                        itemStyle: { borderRadius: 5, borderColor: '#1e293b', borderWidth: 2 },
                        label: { show: false, position: 'center' },
                        emphasis: { label: { show: true, fontSize: 20, fontWeight: 'bold', color: '#fff' } },
                        labelLine: { show: false },
                        data: data.channels
                    }
                ]
            });

            // 4. 渲染分公司排行
            companyRankChart.setOption({
                ...commonOption,
                tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: { type: 'value', splitLine: { show: false }, axisLabel: { show: false } },
                yAxis: { type: 'category', data: data.companies.map(c => c.name).reverse(), axisLabel: { color: '#fff' }, axisLine: { show: false }, axisTick: { show: false } },
                series: [
                    {
                        name: '签约金额',
                        type: 'bar',
                        data: data.companies.map(c => c.value).reverse(),
                        label: { show: true, position: 'right', color: '#fff' },
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                { offset: 0, color: '#3b82f6' },
                                { offset: 1, color: '#2dd4bf' }
                            ]),
                            borderRadius: [0, 4, 4, 0]
                        }
                    }
                ]
            });

            // 5. 渲染销售周期散点图
            cycleChart.setOption({
                ...commonOption,
                tooltip: {
                    formatter: function (param) {
                        return `${param.data[3]}<br/>周期: ${param.data[0]}天<br/>金额: ${param.data[1]}万<br/>类型: ${param.data[2]}`;
                    }
                },
                grid: { left: '5%', right: '10%', bottom: '10%', top: '15%' },
                xAxis: { name: '销售周期 (天)', splitLine: { lineStyle: { color: '#334155', type: 'dashed' } }, axisLabel: { color: '#94a3b8' } },
                yAxis: { name: '签约金额 (万元)', splitLine: { lineStyle: { color: '#334155', type: 'dashed' } }, axisLabel: { color: '#94a3b8' } },
                visualMap: {
                    min: 0, max: 100,
                    dimension: 0,
                    orient: 'horizontal',
                    right: 10, top: 0,
                    text: ['长周期', '短周期'],
                    calculable: true,
                    inRange: { color: ['#34d399', '#facc15', '#f87171'] },
                    textStyle: { color: '#94a3b8' }
                },
                series: [{
                    symbolSize: function (data) { return Math.sqrt(data[1]) * 2; }, // 金额越大圆圈越大
                    data: data.cycleData,
                    type: 'scatter'
                }]
            });
        }

        // 数字滚动动画工具函数
        function animateValue(id, start, end, duration) {
            if (start === end) return;
            var range = end - start;
            var current = start;
            var increment = end > start ? 1 : -1;
            var stepTime = Math.abs(Math.floor(duration / range));
            // 限制最小步长，防止大数字卡顿
            if (range > 100) { increment = Math.ceil(range / 50); stepTime = 20; }
            
            var obj = document.getElementById(id);
            var timer = setInterval(function() {
                current += increment;
                if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                    current = end;
                    clearInterval(timer);
                }
                obj.innerHTML = current.toLocaleString();
            }, stepTime);
        }

        // 页面加载完成后渲染
        window.addEventListener('load', renderDashboard);

        // 窗口大小改变时重绘图表
        window.addEventListener('resize', () => {
            trendChart.resize();
            channelChart.resize();
            companyRankChart.resize();
            cycleChart.resize();
        });

    </script>


</body></html>